{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport styles from \"./styles/LogIn.module.scss\"; //import loadingIcon from \"../GAssets/loading_cat.gif\";\n\nimport PleaseWaitModal from \"./PleaseWaitModal\";\nimport { productionHost, productionURL } from \"./constants\";\nimport store from \"store\";\nimport router from \"next/router\"; // axios.defaults.withCredentials = true;\n\nconst LogIn = () => {\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: inputData,\n    1: setInputData\n  } = useState({\n    name: \"\",\n    pass: \"\"\n  });\n  const {\n    0: token,\n    1: setToken\n  } = useState(\"\");\n  useEffect(() => {\n    // //const jwt = document.cookie.slice(document.cookie.indexOf('=') + 1);\n    axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + store.get(\"jwt\");\n  }, []);\n  useEffect(() => {\n    store.set(\"jwt\", token);\n  }, [token]);\n\n  const sendData = async () => {\n    // console.log(inputData);\n    setIsLoading(true);\n\n    try {\n      const response = await axios.post( // \"http://192.168.8.100:4000/users/log_in\",\n      `${productionURL}users/log_in`, {\n        name: inputData.name,\n        password: inputData.pass\n      }, {\n        withCredentials: true\n      });\n      console.log(response.status);\n      console.log(response);\n      setToken(response.data);\n      setIsLoading(false);\n      router.replace(`${productionHost}/tms/main`);\n    } catch (error) {\n      console.error(error);\n      alert(\"Incorrect username or password!\");\n      setIsLoading(false);\n    }\n  };\n\n  const handleFormSubmission = async e => {\n    e.preventDefault();\n\n    if (inputData.pass.length <= 4 || inputData.name.length <= 4) {\n      alert(\"Username and password must be longer than 4 characters\");\n    } else {\n      await sendData();\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: styles.LogInFormContainer\n  }, __jsx(PleaseWaitModal, {\n    isDisplayed: isLoading\n  }), __jsx(\"form\", {\n    onSubmit: handleFormSubmission,\n    className: styles.infoForm\n  }, __jsx(\"div\", {\n    id: \"u_name\",\n    className: styles.inputField\n  }, __jsx(\"label\", {\n    htmlFor: \"name\"\n  }, \"Username:\"), __jsx(\"input\", {\n    name: \"name\",\n    type: \"text\",\n    onChange: e => setInputData({\n      name: e.target.value,\n      pass: inputData.pass\n    })\n  })), __jsx(\"div\", {\n    id: \"u_pass\",\n    className: styles.inputField\n  }, __jsx(\"label\", {\n    htmlFor: \"pass\"\n  }, \"Password\"), __jsx(\"input\", {\n    type: \"password\",\n    onChange: e => setInputData({\n      pass: e.target.value,\n      name: inputData.name\n    })\n  })), __jsx(\"button\", {\n    disabled: isLoading,\n    type: \"submit\"\n  }, \"Log in\")));\n};\n\nexport default LogIn;","map":null,"metadata":{},"sourceType":"module"}